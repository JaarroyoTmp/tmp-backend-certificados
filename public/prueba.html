<!DOCTYPE html>
<html>
<body>

<h2>Probar API generar-certificado</h2>

<button onclick="probar()">Enviar POST</button>

<pre id="resultado" style="padding:10px; background:#eee; white-space:pre-wrap;"></pre>

<script>
async function probar() {
  const salida = document.getElementById("resultado");
  salida.innerText = "Enviando petición...";

  try {
    const res = await fetch("https://tmp-backend-certificados.vercel.app/api/generar-certificado", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        html: "<h1>Certificado TMP</h1><p>Generado correctamente ✔️</p>",
        filename: "certificado.pdf"
      })
    });

    if (!res.ok) {
      const txt = await res.text();
      salida.innerText = "Error HTTP: " + res.status + "\\n" + txt;
      return;
    }

    // Recibir el PDF como binario
    const blob = await res.blob();
    const url = URL.createObjectURL(blob);

    // Abrir el PDF en una nueva pestaña
    window.open(url, "_blank");

    salida.innerText = "PDF generado correctamente. Abriendo en nueva pestaña...";
  } catch (err) {
    salida.innerText = "ERROR:\\n" + err.toString();
  }
}
</script>

</body>
</html>
